/*************************************************
Canvas Mask Utility v0.1
Author: www.benbarnett.net || @benpbarnett

Copyright (c) 2011 Ben Barnett
Licensed under the MIT license
http://www.opensource.org/licenses/mit-license.php
**************************************************/
function applyCanvasMask(a,b,c,d,e){if(!document.createElement("canvas").getContext&&!e){return a}else if(!document.createElement("canvas").getContext&&e){return a.src}var f=document.createElement("canvas"),g=f.getContext("2d"),h=document.createElement("canvas"),i=h.getContext("2d"),j=null,k=null,l=null;f.width=c;f.height=d*2;h.width=c;h.height=d;g.drawImage(a,0,0);g.drawImage(b,0,d);j=g.getImageData(0,0,c,d);k=j.data;l=g.getImageData(0,d,c,d).data;for(var m=3,n=k.length;m<n;m=m+4){k[m]=l[m]}if(e){i.clearRect(0,0,c,d);i.putImageData(j,0,0);return h.toDataURL()}else{return j}};